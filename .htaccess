php_value session.cookie_lifetime "35650000"

Options All -Indexes
Options +FollowSymLinks

RewriteEngine On

# Rewrite URI's
RewriteCond %{HTTPS} !on
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}

RewriteRule ^search/(.*)$ search/index.php?search=$1 [NC,L]
RewriteRule ^search/[a-z]+/$ search/index.php?search=$1 [NC,L]

# product single item
RewriteRule ^@(.*)/(.*)/status/(.*)/$ status/index.php?uid=$2&status=$3 [NC,L]
RewriteRule ^\*(.*)/(.*)/status/(.*)/$ status/index.php?uid=$2&status=$3 [NC,L]

RewriteRule ^@(.*)$ profile/index.php?profileid=$1 [NC,L]
RewriteRule ^\*(.*)$ profile/index.php?profileid=$1 [NC,L]

RewriteRule ^social/@(.*)$ profile/index.php?profileid=$1 [NC,L]
RewriteRule ^follow/([0-9]+)/([0-9]+)/(.*)$ follow/index.php?profileid=$1&friendid=$2&csrf=$3 [NC,L]
RewriteRule ^social/follow/([0-9]+)/([0-9]+)/(.*)$ follow/index.php?profileid=$1&friendid=$2&csrf=$3 [NC,L]

RewriteRule ^unfollow/([0-9]+)/([0-9]+)/(.*)$ unfollow/index.php?profileid=$1&friendid=$2&csrf=$3 [NC,L]
RewriteRule ^social/unfollow/([0-9]+)/([0-9]+)/(.*)$ unfollow/index.php?profileid=$1&friendid=$2&csrf=$3 [NC,L]

RewriteRule ^social/opt/request/(.*)/([0-9]+)/([0-9]+)/(.*)$ opt/request/index.php?method=$1&profileid=$2&postid=$3&csrf=$4 [NC,L]
RewriteRule ^opt/request/(.*)/([0-9]+)/([0-9]+)/(.*)$ opt/request/index.php?method=$1&profileid=$2&postid=$3&csrf=$4 [NC,L]

RewriteRule ^social/opt/(.*)/([0-9]+)/([0-9]+)/(.*)$ opt/index.php?method=$1&profileid=$2&postid=$3&csrf=$4 [NC,L]
RewriteRule ^opt/(.*)/([0-9]+)/([0-9]+)/(.*)$ opt/index.php?method=$1&profileid=$2&postid=$3&csrf=$4 [NC,L]

RewriteRule ^flag/(.*)/([0-9]+)/([0-9]+)/(.*)$ flag/index.php?method=$1&profileid=$2&postid=$3&csrf=$4 [NC,L]


RewriteRule ^messenger/([0-9]+)/([0-9]+)/$ messenger/messenger.php?uid=$1&toid=$2 [NC,L]
RewriteRule ^messenger/$ messenger/index.php [NC,L]

RewriteRule ^share/(.*)/([0-9]+)/([0-9]+)/(.*)$ share/index.php?method=$1&profileid=$2&postid=$3&csrf=$4 [NC,L]
RewriteRule ^delete/(.*)/([0-9]+)/([0-9]+)/(.*)$ delete/index.php?method=$1&profileid=$2&postid=$3&csrf=$4 [NC,L]
RewriteRule ^verified(.*)$ verify/index.php?code=$1  [NC,L] 

RewriteCond %{REQUEST_METHOD}  ^(HEAD|TRACE|TRACK) [NC,OR]
RewriteCond %{HTTP_REFERER}    ^(.*)(<|>|'|%0A|%0D|%27|%3C|%3E|%00).* [NC,OR]
RewriteCond %{REQUEST_URI}     ^/(,|;|<|>|/{2,999}).* [NC,OR]
RewriteCond %{HTTP_USER_AGENT} ^.*(winhttp|HTTrack|clshttp|archiver).* [NC,OR]
RewriteCond %{HTTP_USER_AGENT} ^.*(libwww|curl|wget|python|nikto|scan).* [NC,OR]
RewriteCond %{HTTP_USER_AGENT} ^.*(<|>|'|%0A|%0D|%27|%3C|%3E|%00).* [NC,OR]
RewriteCond %{HTTP_COOKIE}     ^.*(<|>|'|%0A|%0D|%27|%3C|%3E|%00).* [NC,OR]
RewriteCond %{QUERY_STRING}    ^.*(;|'|").*(union|select|insert|declare|drop|update|md5|benchmark).* [NC,OR]
RewriteCond %{QUERY_STRING}    ^.*(localhost|loopback|127\.0\.0\.1).* [NC,OR]
RewriteCond %{QUERY_STRING}    ^.*(<|>|'|%0A|%0D|%27|%3C|%3E|%00).* [NC]
RewriteRule ^(.*)$ /500.html [NC,L]

<IfModule mod_headers.c>
    Header unset ETag
</IfModule>

<IfVersion < 2.4>
	<FilesMatch "(\.(bak|config|dist|inc|ini|log|sh|sql|swp|csv|htpasswd)|~)$">
   	 	# Apache 2.2
   	 	Order allow,deny
    		Deny from all
    		Satisfy All
   	</FilesMatch>
</IfVersion>

<IfVersion >= 2.4>
	<FilesMatch "(\.(bak|config|dist|inc|ini|log|sh|sql|swp|csv|htpasswd)|~)$">
    		 Require all denied
	</FilesMatch>
</IfVersion>

<IfModule mod_deflate.c>
    # Compress all output labeled with one of the following MIME-types
    <IfModule mod_filter.c>
        AddOutputFilterByType DEFLATE application/atom+xml \
                                      application/javascript \
                                      application/json \
                                      application/rss+xml \
                                      application/x-web-app-manifest+json \
                                      application/xhtml+xml \
                                      application/xml \
                                      font/opentype \
                                      image/svg+xml \
                                      image/x-icon \
                                      text/css \
                                      text/html \
                                      text/plain \
                                      text/x-component \
                                      text/xml
    </IfModule>
</IfModule>